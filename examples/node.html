<!DOCTYPE html>
<style>
  html,
  body,
  textarea {
    width: 100%;
    height: 100%;
    padding: 0;
    margin: 0;
  }
</style>
<textarea id="paste" placeholder="Paste Here!"></textarea>
<script type="module">
  // Import gdb
  import { gdb } from "../dist/index.js";

    const relayUrls = [
    "wss://relay.orangepill.ovh",
    // "wss://purplerelay.com",
    // "wss://pyramid.fiatjaf.com",
    // "wss://nostr.azzamo.net",
    // "wss://strfry.elswa-dev.online",
    // "wss://relay.letsfo.com",
    // "wss://nostr.gleeze.com",
    // "wss://relay.angor.io"
  ];

  // Initialize the database
  let db = await gdb('mesh-cells-monitor', {
    rtc: {
      relayUrls,
      cells: {
        cellSize: '5',
        bridgesPerEdge: 2,
        maxCellSize: 50,
        targetCells: 100,
        debug: false
      }
    }
  });

  // Get the <textarea> element
  const paste = document.getElementById("paste");

  // Unique ID for the textarea content
  const TEXTAREA_ID = "textarea-content";

  // Function to save textarea content to GDB
  const saveContent = async () => {
    const content = paste.value; // Get current textarea content
    await db.put({ content }, TEXTAREA_ID); // Save content to GDB
  };

  // Event to save content in real time
  paste.oninput = async () => {
    await saveContent(); // Save content every time user types
  };

  // Listen for database changes (real-time synchronization)
  db.map(({ id, value }) => {
    if (id === TEXTAREA_ID) {
      paste.value = value.content;
    }
  });
</script>